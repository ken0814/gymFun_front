import{_ as L,a as x,o as c,c as m,d as i,e as n,w as l,f as R,F as y,br as f,S as r,l as F,bo as w,bq as N,bK as I,bn as $,p as E,i as V,j as _}from"./index.a5ae3475.js";import{_ as j}from"./Modal.d50da3c1.js";import{_ as q}from"./Table.28d003f8.js";import{_ as K,a as T}from"./Upload.30dcf065.js";import{a as z,_ as G}from"./FormItem.7cc3184f.js";import{_ as H}from"./Input.6a210c5c.js";import"./Popover.cf2314fc.js";import"./Warning.182183a8.js";const h=u=>(E("data-v-cea8b126"),u=u(),V(),u),J={class:"flex justify-content-space-between",id:"section01"},O=h(()=>i("h1",null,"\u5EE3\u544A\u7BA1\u7406",-1)),P=_("\u65B0\u589E"),Q=_("\u9EDE\u64CA/\u62D6\u66F3\u4E0A\u50B3"),W={class:"flex justify-content-flex-end",id:"modalBtnSection"},X=_("\u9001\u51FA"),Y=_("\u522A\u9664"),Z=_("\u53D6\u6D88"),ee=h(()=>i("thead",null,[i("tr",null,[i("th",null,"\u5EE3\u544A\u5716\u7247"),i("th",null,"\u5EE3\u544A\u540D\u7A31"),i("th",null,"\u7DE8\u8F2F")])],-1)),te=["src"],oe=_("\u7DE8\u8F2F"),ne={key:1},se=h(()=>i("td",{colspan:"3",style:{"text-align":"center"}},"\u6C92\u6709\u5EE3\u544A",-1)),ie=[se],le={__name:"AdminAdvertise",setup(u){const a=x([]),e=x({_id:"",name:"",img:[],description:"",URL:"",idx:-1,submitting:!1,showModal:!1}),b=()=>{e.showModal=!1},k=async()=>{e.submitting=!0;const s=new FormData;for(const t in e)["_id","idx","showModal","submitting"].includes(t)||(t==="image"?e.image.length>0&&s.append(t,e[t][0].file):s.append(t,e[t]));try{if(e._id.length===0){const{data:t}=await f.post("/bill",s);a.push(t.result),r.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:t}=await f.patch("/bill/"+e._id,s);a[e.idx]=t.result,r.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.submitting=!1}catch(t){r.fire({icon:"error",title:"\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}e.submitting=!1},v=(s,t)=>{e._id=s,t>-1?(e.name=a[t].name,e.description=a[t].description,e.URL=a[t].URL):(e.name="",e.description=""),e.image=[],e.idx=t,e.showModal=!0,e.submitting=!1},U=async(s,t)=>{try{await f.delete("/bill/"+s),r.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),a.splice(t,1)}catch(d){r.fire({icon:"error",title:"\u5931\u6557",text:d.isAxiosError?d.response.data.message:d.message})}e.showModal=!1};return(async()=>{try{const{data:s}=await f.get("/bill/all");a.push(...s.result)}catch(s){r.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,t)=>{const d=F,A=K,B=T,p=z,g=H,C=G,D=j,S=q;return c(),m(y,null,[i("div",J,[O,n(d,{color:"#D74B4B",onClick:t[0]||(t[0]=o=>v("",-1))},{default:l(()=>[P]),_:1})]),n(D,{show:e.showModal,"onUpdate:show":t[6]||(t[6]=o=>e.showModal=o),"mask-closable":!0,preset:"card",onSubmit:R(k,["prevent"]),id:"admin-advertise-modal"},{default:l(()=>[i("h3",null,w(e._id.length>0?"\u7DE8\u8F2F\u5EE3\u544A":"\u65B0\u589E\u5EE3\u544A"),1),n(C,{ref:"formRef",model:e},{default:l(()=>[n(p,{path:"advertiseImage",label:"\u4E0A\u50B3\u5716\u7247"},{default:l(()=>[n(B,{"directory-dnd":"","file-list":e.image,"onUpdate:file-list":t[1]||(t[1]=o=>e.image=o)},{default:l(()=>[n(A,null,{default:l(()=>[Q]),_:1})]),_:1},8,["file-list"])]),_:1}),n(p,{path:"advertiseName",label:"\u5EE3\u544A\u540D\u7A31"},{default:l(()=>[n(g,{value:e.name,"onUpdate:value":t[2]||(t[2]=o=>e.name=o),type:"text",placeholder:"\u8F38\u5165\u5EE3\u544A\u540D\u7A31"},null,8,["value"])]),_:1}),n(p,{path:"advertiseURL",label:"\u5EE3\u544A\u7DB2\u5740"},{default:l(()=>[n(g,{value:e.URL,"onUpdate:value":t[3]||(t[3]=o=>e.URL=o),type:"text",placeholder:"\u8F38\u5165\u5EE3\u544A\u7DB2\u5740"},null,8,["value"])]),_:1}),n(p,{path:"advertiseName",label:"\u5EE3\u544A\u5167\u5BB9"},{default:l(()=>[n(g,{value:e.description,"onUpdate:value":t[4]||(t[4]=o=>e.description=o),type:"textarea",placeholder:"\u8F38\u5165\u5EE3\u544A\u5167\u5BB9"},null,8,["value"])]),_:1}),i("div",W,[n(d,{"attr-type":"submit",color:"#475F77",loading:e.submitting,onClick:b},{default:l(()=>[X]),_:1},8,["loading"]),e._id.length>0?(c(),N(d,{key:0,color:"#D74B4B",loading:e.submitting,onClick:t[5]||(t[5]=o=>U(e._id,e.idx))},{default:l(()=>[Y]),_:1},8,["loading"])):I("",!0),n(d,{color:"#DCDDD8",disable:e.submitting,onClick:b},{default:l(()=>[Z]),_:1},8,["disable"])])]),_:1},8,["model"])]),_:1},8,["show","onSubmit"]),n(S,{bordered:!1,"single-line":!1,id:"table"},{default:l(()=>[ee,i("tbody",null,[a.length>0?(c(!0),m(y,{key:0},$(a,(o,M)=>(c(),m("tr",{key:o._id},[i("td",null,[i("img",{src:o.image},null,8,te)]),i("td",null,w(o.name),1),i("td",null,[n(d,{color:"#475F77",onClick:de=>v(o._id,M)},{default:l(()=>[oe]),_:2},1032,["onClick"])])]))),128)):(c(),m("tr",ne,ie))])]),_:1})],64)}}},he=L(le,[["__scopeId","data-v-cea8b126"]]);export{he as default};
