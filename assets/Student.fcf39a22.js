import{_ as j,a as g,r as A,H as U,N as V,o as i,c as d,e as a,w as u,d as s,F as b,br as v,S as m,f as z,bn as H,g as w,p as L,i as O,j as P,l as T,bo as f}from"./index.5dc221ca.js";import{E as $}from"./EditCalendarOutlined.355ed1c4.js";import{_ as q}from"./Modal.ff7ad78b.js";import{_ as G}from"./Table.0723c38c.js";import{_ as J}from"./Pagination.ac282539.js";import{_ as K}from"./Select.8fc08c6b.js";import{a as Q,_ as R}from"./FormItem.2467c2f5.js";import"./Popover.dbc32cc0.js";import"./Input.64ef045e.js";import"./Warning.a2d52b1d.js";const p=_=>(L("data-v-4e0d184f"),_=_(),O(),_),W=p(()=>s("div",{class:"flex justify-content-space-between",id:"section01"},[s("h1",null,"\u5B78\u54E1\u7BA1\u7406")],-1)),X=p(()=>s("h1",null,"\u5831\u540D\u5BE9\u67E5",-1)),Y={class:"flex justify-content-flex-end",id:"btnSection"},Z=P("\u9001\u51FA"),tt={id:"section02"},et=p(()=>s("thead",null,[s("tr",null,[s("th",null,"\u5B78\u54E1"),s("th",null,"\u5831\u540D\u8AB2\u7A0B"),s("th",null,"\u5831\u540D\u72C0\u614B"),s("th",null,"\u5BE9\u67E5")])],-1)),st={key:1},ot=p(()=>s("td",{colspan:"4",style:{"text-align":"center"}},"\u6C92\u6709\u5B78\u54E1",-1)),nt=[ot],at={__name:"Student",setup(_){const t=g({_id:"",status:[],courseName:"",studentName:"",showModal:!1,submitting:!1}),l=g([]),c=A(1),r=5,y=U(()=>l.slice(c.value*r-r,c.value*r)),x=[{label:"\u5BE9\u67E5\u901A\u904E",value:1},{label:"\u5BE9\u67E5\u9000\u56DE",value:2}],S=(n,e)=>{t._id=n,e>-1?(t.courseName=l[e].course.name,t.studentName=l[e].studentDocument.name):(t.status="",t.courseName="",t.studentName=""),t.idx=e,t.showModal=!0,t.submitting=!1},N=async()=>{t.submitting=!0;const n={status:t.status};try{const{data:e}=await v.patch("/users/history/"+t._id,n);console.log(e.result),console.log(l[t.idx].status),l[t.idx].status=e.result.status,m.fire({icon:"success",title:"\u6210\u529F",text:"\u6210\u529F\u9001\u51FA"}),t.status=null,t.showModal=!1}catch(e){m.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message}),t.showModal=!1}};return(async()=>{try{const{data:n}=await v.get("/users//register");l.push(...n.final)}catch(n){m.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError&&n.response.data?n.response.data.message:"\u767C\u751F\u932F\u8AA4"})}})(),(n,e)=>{const M=K,k=Q,h=T,B=R,D=q,E=V,F=G,I=J;return i(),d(b,null,[W,a(D,{show:t.showModal,"onUpdate:show":e[1]||(e[1]=o=>t.showModal=o),"mask-closable":!0,preset:"card",style:{width:"500px"},id:"modal"},{default:u(()=>[X,a(B,{model:t,onSubmit:z(N,["prevent"])},{default:u(()=>[a(k,{path:"status",label:"\u5BE9\u67E5\u7D50\u679C"},{default:u(()=>[a(M,{value:t.status,"onUpdate:value":e[0]||(e[0]=o=>t.status=o),options:x,placeholder:"\u8ACB\u9078\u64C7"},null,8,["value"])]),_:1}),s("div",Y,[a(h,{color:"#D74B4B","attr-type":"submit"},{default:u(()=>[Z]),_:1})])]),_:1},8,["model","onSubmit"])]),_:1},8,["show"]),s("div",tt,[a(F,{bordered:!1,"single-line":!1,id:"table"},{default:u(()=>[et,s("tbody",null,[l.length>0?(i(!0),d(b,{key:0},H(w(y),(o,C)=>(i(),d("tr",{key:o._id},[s("td",null,f(o.studentDocument.name),1),s("td",null,f(o.course.name),1),s("td",null,f(o.status===0?"\u5BE9\u67E5\u4E2D":o.status===1?"\u5831\u540D\u6210\u529F":o.status===2?"\u5831\u540D\u8ACB\u6C42\u9000\u56DE":""),1),s("td",null,[a(h,{color:"#475F77",onClick:ut=>S(o._id,C+(c.value-1)*r)},{default:u(()=>[a(E,{size:"25",color:"#fff",component:w($)},null,8,["component"])]),_:2},1032,["onClick"])])]))),128)):(i(),d("tr",st,nt))])]),_:1})]),a(I,{page:c.value,"onUpdate:page":e[2]||(e[2]=o=>c.value=o),"page-count":Math.ceil(l.length/r)},null,8,["page","page-count"])],64)}}},bt=j(at,[["__scopeId","data-v-4e0d184f"]]);export{bt as default};
